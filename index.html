<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rhetoric Lab: Intent Investigator</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // Custom Icon Component to handle Lucide in CDN environment
        const Icon = ({ name, size = 24, className = "" }) => {
            const [svg, setSvg] = useState("");
            useEffect(() => {
                if (window.lucide) {
                    const iconSvg = lucide.createIcons();
                }
            }, []);
            return <i data-lucide={name} className={className} style={{ width: size, height: size }}></i>;
        };

        const RHETORICAL_DATA = {
            devices: [
                {
                    id: 'rhetorical_question',
                    name: 'Rhetorical Question',
                    definition: 'A question asked for effect or to lay emphasis on some point discussed when no real answer is expected.',
                    intent: 'To provoke thought, emphasize a point, or lead the audience to a specific conclusion without stating it directly.',
                    example: '"Can we really afford to ignore the rising tides any longer?"'
                },
                {
                    id: 'personification',
                    name: 'Personification',
                    definition: 'Attributing human qualities to non-human things or abstract ideas.',
                    intent: 'To create an emotional connection, make complex ideas more relatable, or highlight the power/agency of a concept.',
                    example: '"The wind whispered secrets of the coming storm through the cracks in the window."'
                },
                {
                    id: 'allusion',
                    name: 'Allusion',
                    definition: 'A brief and indirect reference to a person, place, thing, or idea of historical, cultural, literary, or political significance.',
                    intent: 'To tap into the audience\'s existing knowledge, establish credibility (ethos), or create complex layers of meaning efficiently.',
                    example: '"He was a real Romeo with the ladies, or so he thought."'
                }
            ],
            challenges: [
                {
                    id: 1,
                    text: "The sun stretched its golden fingers across the valley, waking the sleeping flowers.",
                    device: "personification",
                    intendedEffect: "To characterize the morning as gentle and nurturing, creating a peaceful mood for the reader.",
                    distractors: [
                        "To provide a scientific explanation of photosynthesis.",
                        "To warn the reader about the dangers of heat stroke.",
                        "To establish the author's authority on meteorology."
                    ]
                },
                {
                    id: 2,
                    text: "If we don't act now, are we not simply inviting catastrophe to dinner?",
                    device: "rhetorical_question",
                    intendedEffect: "To highlight the absurdity of inaction and make the audience feel responsible for the outcome.",
                    distractors: [
                        "To find out if the audience has enough food for a dinner party.",
                        "To gather data on how many people believe in climate change.",
                        "To confuse the audience so they won't ask about costs."
                    ]
                },
                {
                    id: 3,
                    text: "He was a regular Einstein when it came to fixing cars, though he'd never finished high school.",
                    device: "allusion",
                    intendedEffect: "To immediately signal the man's high intelligence through a shared cultural reference, saving time on description.",
                    distractors: [
                        "To suggest the man was actually a theoretical physicist.",
                        "To criticize the man for his lack of formal education.",
                        "To mock the man's inability to understand complex machinery."
                    ]
                },
                {
                    id: 4,
                    text: "Justice is blind, yet she sees the truth hidden in our hearts.",
                    device: "personification",
                    intendedEffect: "To present justice as an impartial yet all-knowing entity, evoking a sense of solemnity and fairness.",
                    distractors: [
                        "To complain about the physical disabilities of judges.",
                        "To suggest that legal systems are fundamentally broken.",
                        "To provide a literal description of a statue in front of a courthouse."
                    ]
                }
            ]
        };

        const App = () => {
            const [view, setView] = useState('landing');
            const [score, setScore] = useState(0);
            const [currentChallenge, setCurrentChallenge] = useState(0);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [isAnswered, setIsAnswered] = useState(false);
            const [feedback, setFeedback] = useState('');

            useEffect(() => {
                if (window.lucide) lucide.createIcons();
            }, [view, isAnswered, currentChallenge]);

            const LandingPage = () => (
                <div className="flex flex-col items-center justify-center min-h-[70vh] text-center p-6">
                    <div className="bg-indigo-600 p-4 rounded-full mb-6 shadow-lg animate-bounce text-white">
                        <i data-lucide="target" size="48"></i>
                    </div>
                    <h1 className="text-3xl font-bold text-slate-900 mb-4">Rhetoric Lab: Intent Investigator</h1>
                    <p className="text-lg text-slate-600 max-w-2xl mb-8">
                        Master the art of identifying rhetorical devices and—more importantly—deciphering <strong>why</strong> authors use them to influence their audience.
                    </p>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-md">
                        <button onClick={() => setView('gallery')} className="flex items-center justify-between p-4 bg-white border-2 border-slate-200 rounded-xl hover:border-indigo-500 hover:bg-indigo-50 transition-all group">
                            <div className="text-left">
                                <span className="block font-bold text-slate-800">The Gallery</span>
                                <span className="text-sm text-slate-500">Review the fundamentals</span>
                            </div>
                            <i data-lucide="book-open" className="text-slate-400 group-hover:text-indigo-600"></i>
                        </button>
                        <button onClick={() => { setView('challenge'); setCurrentChallenge(0); setScore(0); setIsAnswered(false); }} className="flex items-center justify-between p-4 bg-white border-2 border-slate-200 rounded-xl hover:border-emerald-500 hover:bg-emerald-50 transition-all group">
                            <div className="text-left">
                                <span className="block font-bold text-slate-800">Intent Challenge</span>
                                <span className="text-sm text-slate-500">Test your analysis skills</span>
                            </div>
                            <i data-lucide="trophy" className="text-slate-400 group-hover:text-emerald-600"></i>
                        </button>
                    </div>
                </div>
            );

            const Gallery = () => (
                <div className="max-w-4xl mx-auto p-6">
                    <button onClick={() => setView('landing')} className="flex items-center text-indigo-600 font-medium mb-6 hover:underline">
                        <i data-lucide="rotate-ccw" className="mr-2" style={{width:16}}></i> Back to Dashboard
                    </button>
                    <h2 className="text-2xl font-bold mb-8 flex items-center">
                        <i data-lucide="book-open" className="mr-3 text-indigo-600"></i> The Device Gallery
                    </h2>
                    <div className="space-y-6">
                        {RHETORICAL_DATA.devices.map((device) => (
                            <div key={device.id} className="bg-white rounded-2xl shadow-sm border border-slate-200 p-6">
                                <h3 className="text-xl font-bold text-indigo-900 mb-4">{device.name}</h3>
                                <div className="grid md:grid-cols-2 gap-6">
                                    <div>
                                        <h4 className="text-xs font-semibold text-slate-400 uppercase mb-2 tracking-widest">Definition</h4>
                                        <p className="text-slate-700">{device.definition}</p>
                                        <div className="mt-4 p-3 bg-slate-50 border-l-4 border-slate-300 rounded-r-lg italic text-slate-600">{device.example}</div>
                                    </div>
                                    <div className="bg-indigo-50/50 p-4 rounded-xl border border-indigo-100">
                                        <h4 className="text-xs font-semibold text-indigo-400 uppercase mb-2 flex items-center tracking-widest">
                                            <i data-lucide="lightbulb" className="mr-1" style={{width:14}}></i> Strategic Intent
                                        </h4>
                                        <p className="text-indigo-900 font-medium leading-relaxed italic">"{device.intent}"</p>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );

            const Challenge = () => {
                const challenge = RHETORICAL_DATA.challenges[currentChallenge];
                const options = useMemo(() => {
                    const all = [
                        { text: challenge.intendedEffect, correct: true },
                        ...challenge.distractors.map(d => ({ text: d, correct: false }))
                    ];
                    return all.sort(() => Math.random() - 0.5);
                }, [currentChallenge]);

                const handleAnswer = (option) => {
                    if (isAnswered) return;
                    setSelectedAnswer(option);
                    setIsAnswered(true);
                    if (option.correct) {
                        setScore(s => s + 1);
                        setFeedback("Correct! You've identified the 'Why' behind the author's choice.");
                    } else {
                        setFeedback("Not quite. Remember to look for the function—how this choice helps the author achieve their purpose.");
                    }
                };

                return (
                    <div className="max-w-2xl mx-auto p-4 md:p-6">
                        <div className="flex justify-between items-center mb-6">
                            <div className="text-xs font-bold text-slate-400 uppercase">Challenge {currentChallenge + 1} / {RHETORICAL_DATA.challenges.length}</div>
                            <div className="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full font-bold text-sm">Score: {score}</div>
                        </div>

                        <div className="bg-slate-900 rounded-3xl p-6 md:p-8 mb-6 shadow-xl text-white">
                            <h3 className="text-slate-400 text-xs font-bold uppercase tracking-widest mb-4">The Passage</h3>
                            <p className="text-xl md:text-2xl font-serif italic leading-relaxed">"{challenge.text}"</p>
                            <div className="mt-6">
                                <span className="text-[10px] font-bold text-indigo-300 bg-indigo-900/50 px-2 py-1 rounded">DEVICE: {challenge.device.replace('_', ' ').toUpperCase()}</span>
                            </div>
                        </div>

                        <h4 className="text-lg font-bold text-slate-800 mb-4">Which best describes the author's <span className="text-indigo-600">intent</span>?</h4>
                        <div className="space-y-3">
                            {options.map((option, idx) => (
                                <button key={idx} onClick={() => handleAnswer(option)} disabled={isAnswered}
                                    className={`w-full text-left p-4 rounded-xl border-2 transition-all flex items-start gap-3
                                        ${!isAnswered ? 'bg-white border-slate-200 hover:border-indigo-300' : ''}
                                        ${isAnswered && option.correct ? 'bg-emerald-50 border-emerald-500' : ''}
                                        ${isAnswered && !option.correct && selectedAnswer === option ? 'bg-rose-50 border-rose-500' : ''}
                                        ${isAnswered && selectedAnswer !== option && !option.correct ? 'opacity-50' : ''}
                                    `}>
                                    <span className="font-medium text-slate-700">{option.text}</span>
                                </button>
                            ))}
                        </div>

                        {isAnswered && (
                            <div className="mt-8 animate-in fade-in transition-all">
                                <div className={`p-4 rounded-xl mb-4 text-sm font-bold ${selectedAnswer.correct ? 'bg-emerald-100 text-emerald-800' : 'bg-rose-100 text-rose-800'}`}>
                                    {feedback}
                                </div>
                                <button onClick={() => {
                                    if (currentChallenge < RHETORICAL_DATA.challenges.length - 1) {
                                        setCurrentChallenge(c => c + 1); setIsAnswered(false); setSelectedAnswer(null);
                                    } else { setView('results'); }
                                }} className="w-full bg-slate-900 text-white py-4 rounded-xl font-bold">
                                    {currentChallenge < RHETORICAL_DATA.challenges.length - 1 ? 'Next Challenge' : 'See Results'}
                                </button>
                            </div>
                        )}
                    </div>
                );
            };

            const Results = () => (
                <div className="flex flex-col items-center justify-center min-h-[70vh] text-center p-6">
                    <div className="bg-yellow-400 p-6 rounded-full mb-6 text-white shadow-xl">
                        <i data-lucide="trophy" size="64"></i>
                    </div>
                    <h2 className="text-3xl font-bold mb-2">Investigation Complete!</h2>
                    <p className="text-slate-600 mb-8">You successfully deciphered {score} out of {RHETORICAL_DATA.challenges.length} rhetorical intents.</p>
                    <button onClick={() => setView('landing')} className="px-8 py-3 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-700">Play Again</button>
                </div>
            );

            return (
                <div className="min-h-screen">
                    <nav className="bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center sticky top-0 z-10">
                        <div className="flex items-center gap-2">
                            <i data-lucide="target" className="text-indigo-600"></i>
                            <span className="font-bold text-lg hidden sm:inline">Rhetoric Lab</span>
                        </div>
                        <div className="flex gap-4 text-sm font-bold">
                            <button onClick={() => setView('gallery')} className={view === 'gallery' ? 'text-indigo-600' : 'text-slate-500'}>Gallery</button>
                            <button onClick={() => setView('landing')} className={view === 'landing' ? 'text-indigo-600' : 'text-slate-500'}>Home</button>
                        </div>
                    </nav>
                    <main className="container mx-auto pb-20">
                        {view === 'landing' && <LandingPage />}
                        {view === 'gallery' && <Gallery />}
                        {view === 'challenge' && <Challenge />}
                        {view === 'results' && <Results />}
                    </main>
                    <footer className="fixed bottom-0 left-0 right-0 bg-white border-t p-3 text-center text-[10px] uppercase tracking-widest text-slate-400 font-bold">
                        Powered by the What-How-Why Framework
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>