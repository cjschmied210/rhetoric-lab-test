<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rhetoric Lab: Intent Investigator</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            -webkit-tap-highlight-color: transparent;
        }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 min-h-screen pb-20">

    <!-- Navigation -->
    <nav class="bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center sticky top-0 z-50">
        <div class="flex items-center gap-2">
            <div class="bg-indigo-600 p-1.5 rounded-lg text-white">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
            </div>
            <span class="font-bold text-lg text-slate-800">Rhetoric Lab</span>
        </div>
        <div class="flex gap-4">
            <button onclick="showView('landing')" class="text-xs font-bold uppercase tracking-wider text-slate-500 hover:text-indigo-600">Home</button>
            <button onclick="showView('gallery')" class="text-xs font-bold uppercase tracking-wider text-slate-500 hover:text-indigo-600">Gallery</button>
        </div>
    </nav>

    <div id="app-content" class="container mx-auto px-4 mt-8">
        <!-- Content injected by JavaScript -->
    </div>

    <footer class="fixed bottom-0 left-0 right-0 bg-white border-t p-3 text-center text-[10px] uppercase tracking-widest text-slate-400 font-bold z-40">
        Powered by the What-How-Why Framework
    </footer>

    <script>
        // --- Data ---
        const RHETORICAL_DATA = {
            devices: [
                {
                    id: 'rhetorical_question',
                    name: 'Rhetorical Question',
                    definition: 'A question asked for effect or to lay emphasis on some point discussed when no real answer is expected.',
                    intent: 'To provoke thought, emphasize a point, or lead the audience to a specific conclusion without stating it directly.',
                    example: '"Can we really afford to ignore the rising tides any longer?"'
                },
                {
                    id: 'personification',
                    name: 'Personification',
                    definition: 'Attributing human qualities to non-human things or abstract ideas.',
                    intent: 'To create an emotional connection, make complex ideas more relatable, or highlight the power/agency of a concept.',
                    example: '"The wind whispered secrets of the coming storm through the cracks in the window."'
                },
                {
                    id: 'allusion',
                    name: 'Allusion',
                    definition: 'A brief and indirect reference to a person, place, thing, or idea of historical, cultural, literary, or political significance.',
                    intent: 'To tap into the audience\'s existing knowledge, establish credibility (ethos), or create complex layers of meaning efficiently.',
                    example: '"He was a real Romeo with the ladies, or so he thought."'
                }
            ],
            challenges: [
                {
                    id: 1,
                    text: "The sun stretched its golden fingers across the valley, waking the sleeping flowers.",
                    device: "personification",
                    intendedEffect: "To characterize the morning as gentle and nurturing, creating a peaceful mood for the reader.",
                    distractors: [
                        "To provide a scientific explanation of photosynthesis.",
                        "To warn the reader about the dangers of heat stroke.",
                        "To establish the author's authority on meteorology."
                    ]
                },
                {
                    id: 2,
                    text: "If we don't act now, are we not simply inviting catastrophe to dinner?",
                    device: "rhetorical_question",
                    intendedEffect: "To highlight the absurdity of inaction and make the audience feel responsible for the outcome.",
                    distractors: [
                        "To find out if the audience has enough food for a dinner party.",
                        "To gather data on how many people believe in climate change.",
                        "To confuse the audience so they won't ask about costs."
                    ]
                },
                {
                    id: 3,
                    text: "He was a regular Einstein when it came to fixing cars, though he'd never finished high school.",
                    device: "allusion",
                    intendedEffect: "To immediately signal the man's high intelligence through a shared cultural reference, saving time on description.",
                    distractors: [
                        "To suggest the man was actually a theoretical physicist.",
                        "To criticize the man for his lack of formal education.",
                        "To mock the man's inability to understand complex machinery."
                    ]
                },
                {
                    id: 4,
                    text: "Justice is blind, yet she sees the truth hidden in our hearts.",
                    device: "personification",
                    intendedEffect: "To present justice as an impartial yet all-knowing entity, evoking a sense of solemnity and fairness.",
                    distractors: [
                        "To complain about the physical disabilities of judges.",
                        "To suggest that legal systems are fundamentally broken.",
                        "To provide a literal description of a statue in front of a courthouse."
                    ]
                }
            ]
        };

        // --- State Management ---
        let currentView = 'landing';
        let score = 0;
        let currentChallengeIndex = 0;
        let isAnswered = false;

        const container = document.getElementById('app-content');

        // --- View Functions ---
        function showView(view) {
            currentView = view;
            render();
        }

        function startChallenge() {
            score = 0;
            currentChallengeIndex = 0;
            isAnswered = false;
            showView('challenge');
        }

        function handleAnswer(isCorrect, element) {
            if (isAnswered) return;
            isAnswered = true;
            
            if (isCorrect) score++;
            
            // Re-render to show feedback
            renderChallenge(isCorrect, element.textContent.trim());
        }

        function nextChallenge() {
            if (currentChallengeIndex < RHETORICAL_DATA.challenges.length - 1) {
                currentChallengeIndex++;
                isAnswered = false;
                showView('challenge');
            } else {
                showView('results');
            }
        }

        // --- Rendering Engine ---
        function render() {
            container.innerHTML = '';
            container.className = "container mx-auto px-4 mt-8 fade-in";

            if (currentView === 'landing') {
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center min-h-[60vh] text-center max-w-2xl mx-auto">
                        <div class="bg-indigo-600 p-5 rounded-full mb-6 shadow-xl text-white">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
                        </div>
                        <h1 class="text-4xl font-bold text-slate-900 mb-4">Intent Investigator</h1>
                        <p class="text-lg text-slate-600 mb-10">Master rhetorical analysis by identifying the <strong>strategic purpose</strong> behind authorial choices.</p>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 w-full">
                            <button onclick="showView('gallery')" class="p-6 bg-white border-2 border-slate-200 rounded-2xl hover:border-indigo-500 hover:bg-indigo-50 transition-all text-left shadow-sm group">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-bold text-slate-800">The Gallery</span>
                                    <svg class="text-slate-300 group-hover:text-indigo-500" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a4 4 0 0 0-4-4H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a4 4 0 0 1 4-4h6z"/></svg>
                                </div>
                                <span class="text-sm text-slate-500">Review the fundamentals of Questioning, Personification, and Allusion.</span>
                            </button>
                            <button onclick="startChallenge()" class="p-6 bg-white border-2 border-slate-200 rounded-2xl hover:border-emerald-500 hover:bg-emerald-50 transition-all text-left shadow-sm group">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-bold text-slate-800">Intent Challenge</span>
                                    <svg class="text-slate-300 group-hover:text-emerald-500" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>
                                </div>
                                <span class="text-sm text-slate-500">Test your ability to connect rhetorical choices to their intended audience effect.</span>
                            </button>
                        </div>
                    </div>
                `;
            } else if (currentView === 'gallery') {
                let html = `
                    <div class="max-w-4xl mx-auto mb-10">
                        <h2 class="text-3xl font-bold text-slate-900 mb-8 flex items-center gap-3">
                             <svg class="text-indigo-600" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a4 4 0 0 0-4-4H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a4 4 0 0 1 4-4h6z"/></svg>
                             The Device Gallery
                        </h2>
                        <div class="space-y-6">
                `;
                RHETORICAL_DATA.devices.forEach(device => {
                    html += `
                        <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 md:p-8">
                            <h3 class="text-2xl font-bold text-indigo-900 mb-4">${device.name}</h3>
                            <div class="grid md:grid-cols-2 gap-8">
                                <div>
                                    <h4 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-3">Definition</h4>
                                    <p class="text-slate-700 leading-relaxed mb-4">${device.definition}</p>
                                    <div class="p-4 bg-slate-50 border-l-4 border-indigo-200 rounded-r-lg italic text-slate-600 font-serif">
                                        ${device.example}
                                    </div>
                                </div>
                                <div class="bg-indigo-50/50 p-6 rounded-2xl border border-indigo-100">
                                    <h4 class="text-xs font-bold text-indigo-400 uppercase tracking-widest mb-3 flex items-center gap-2">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>
                                        Strategic Intent
                                    </h4>
                                    <p class="text-indigo-900 font-bold leading-relaxed">"${device.intent}"</p>
                                </div>
                            </div>
                        </div>
                    `;
                });
                html += `</div></div>`;
                container.innerHTML = html;
            } else if (currentView === 'challenge') {
                renderChallenge();
            } else if (currentView === 'results') {
                const percent = Math.round((score / RHETORICAL_DATA.challenges.length) * 100);
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center min-h-[60vh] text-center max-w-md mx-auto">
                        <div class="bg-yellow-400 p-6 rounded-full mb-6 shadow-xl text-white">
                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>
                        </div>
                        <h2 class="text-3xl font-bold text-slate-900 mb-2">Analysis Complete!</h2>
                        <p class="text-lg text-slate-500 mb-8">You scored ${score} out of ${RHETORICAL_DATA.challenges.length} correctly.</p>
                        
                        <div class="w-full bg-white p-6 rounded-2xl border border-slate-200 shadow-sm mb-8">
                             <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-bold text-slate-400 uppercase tracking-tighter">Accuracy</span>
                                <span class="text-lg font-bold text-indigo-600">${percent}%</span>
                             </div>
                             <div class="w-full bg-slate-100 h-3 rounded-full overflow-hidden">
                                <div class="bg-indigo-600 h-full transition-all duration-1000" style="width: ${percent}%"></div>
                             </div>
                        </div>

                        <button onclick="showView('landing')" class="w-full bg-indigo-600 text-white py-4 rounded-xl font-bold hover:bg-indigo-700 transition-all shadow-lg shadow-indigo-100">Back to Home</button>
                    </div>
                `;
            }
        }

        function renderChallenge(lastCorrect = null, lastSelectedText = null) {
            const challenge = RHETORICAL_DATA.challenges[currentChallengeIndex];
            
            // Create options only if not already answered or rendering fresh
            if (!isAnswered) {
                const rawOptions = [
                    { text: challenge.intendedEffect, correct: true },
                    ...challenge.distractors.map(d => ({ text: d, correct: false }))
                ];
                window.currentOptions = rawOptions.sort(() => Math.random() - 0.5);
            }

            let html = `
                <div class="max-w-2xl mx-auto mb-10">
                    <div class="flex justify-between items-center mb-6">
                        <span class="text-xs font-bold text-slate-400 uppercase tracking-widest">Challenge ${currentChallengeIndex + 1} of ${RHETORICAL_DATA.challenges.length}</span>
                        <span class="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full font-bold text-xs">Score: ${score}</span>
                    </div>

                    <div class="bg-slate-900 rounded-[2rem] p-8 md:p-10 mb-8 shadow-2xl relative overflow-hidden">
                        <div class="relative z-10">
                            <h3 class="text-slate-500 text-[10px] font-bold uppercase tracking-[0.2em] mb-4">The Textual Evidence</h3>
                            <p class="text-2xl md:text-3xl text-white font-serif italic leading-snug">"${challenge.text}"</p>
                            <div class="mt-8">
                                <span class="text-[10px] font-bold text-indigo-400 bg-indigo-500/10 px-3 py-1.5 rounded-full border border-indigo-500/30">
                                    DEVICE: ${challenge.device.replace('_', ' ').toUpperCase()}
                                </span>
                            </div>
                        </div>
                    </div>

                    <h4 class="text-lg font-bold text-slate-800 mb-6">Which best captures the author's <span class="text-indigo-600 underline underline-offset-4 decoration-indigo-200">intent</span>?</h4>
                    <div class="space-y-3">
            `;

            window.currentOptions.forEach((option, idx) => {
                let btnClass = "w-full text-left p-5 rounded-2xl border-2 transition-all flex items-start gap-4 ";
                let indicatorClass = "w-6 h-6 rounded-full flex-shrink-0 flex items-center justify-center text-xs font-bold mt-0.5 ";

                if (!isAnswered) {
                    btnClass += "bg-white border-slate-200 hover:border-indigo-400 hover:shadow-md";
                    indicatorClass += "bg-slate-100 text-slate-400";
                } else {
                    if (option.correct) {
                        btnClass += "bg-emerald-50 border-emerald-500 ring-4 ring-emerald-50";
                        indicatorClass += "bg-emerald-500 text-white";
                    } else if (option.text === lastSelectedText) {
                        btnClass += "bg-rose-50 border-rose-500";
                        indicatorClass += "bg-rose-500 text-white";
                    } else {
                        btnClass += "bg-slate-50 border-slate-100 opacity-50";
                        indicatorClass += "bg-slate-200 text-slate-400";
                    }
                }

                html += `
                    <button onclick="handleAnswer(${option.correct}, this)" class="${btnClass}" ${isAnswered ? 'disabled' : ''}>
                        <div class="${indicatorClass}">${isAnswered && option.correct ? 'âœ“' : String.fromCharCode(65 + idx)}</div>
                        <span class="font-medium ${isAnswered && option.correct ? 'text-emerald-900' : 'text-slate-700'}">${option.text}</span>
                    </button>
                `;
            });

            html += `</div>`;

            if (isAnswered) {
                const feedbackMsg = lastCorrect 
                    ? "Correct! You successfully connected the device to its rhetorical function." 
                    : "Not quite. Remember to focus on <strong>why</strong> the author made this choice for the audience.";
                
                html += `
                    <div class="mt-8 fade-in">
                        <div class="p-5 rounded-2xl mb-4 flex items-start gap-4 ${lastCorrect ? 'bg-emerald-100 text-emerald-800' : 'bg-rose-100 text-rose-800'}">
                            <p class="text-sm font-bold leading-relaxed">${feedbackMsg}</p>
                        </div>
                        <button onclick="nextChallenge()" class="w-full bg-slate-900 text-white py-5 rounded-2xl font-bold flex items-center justify-center gap-2 hover:bg-slate-800 transition-all shadow-xl">
                            ${currentChallengeIndex < RHETORICAL_DATA.challenges.length - 1 ? 'Next Challenge' : 'See Final Results'}
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
                        </button>
                    </div>
                `;
            }

            html += `</div>`;
            container.innerHTML = html;
        }

        // Initialize
        window.onload = () => showView('landing');
    </script>
</body>
</html>